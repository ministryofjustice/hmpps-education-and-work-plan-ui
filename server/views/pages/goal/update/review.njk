{% extends "../../../partials/layout.njk" %}

{% set pageId = "review-update-goal" %}
{% set pageTitle = applicationName + " - Home" %}

{% block beforeContent %}
  {{ govukBreadcrumbs({
    items: [
      {
        text: "Digital Prison Services",
        href: dpsUrl
      },
      {
        text: "Manage learning and work progress",
        href: "/"
      },
      {
        text: "Manage " + prisonerSummary.firstName | capitalize + " " + prisonerSummary.lastName | capitalize + "'s learning plan",
        href: "/plan/" + prisonerSummary.prisonNumber + "/view/overview"
      }
    ],
    classes: 'govuk-!-display-none-print'
  }) }}
{% endblock %}

{% block content %}

  {% include "../../../partials/prisonerBanner.njk" %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      <h1 class="govuk-heading-l">Check your updates for {{ prisonerSummary.firstName | capitalize }} {{ prisonerSummary.lastName | capitalize }}'s goals</h1>

      <h2 class="govuk-heading-m govuk-visually-hidden">Goal details</h2>

      {{ form | dump }}
      {{ data | dump }}

      {{ govukSummaryList({
        classes: 'govuk-!-margin-bottom-9',
        rows: [
          {
            key: {
              text: "Description"
            },
            value: {
              text: data.description
            }
          },
          {
            key: {
              text: "Status"
            },
            value: {
              text: data.status
            }
          },
          {
            key: {
              text: "Note"
            },
            value: {
              text: data.note
            }
          }
        ]
      }) }}     

      <table class="govuk-table">
        <caption class="govuk-table__caption govuk-table__caption--m govuk-visually-hidden">Step details</caption>
        <thead class="govuk-table__head govuk-visually-hidden">
          <tr class="govuk-table__row">
            <th scope="col" class="govuk-table__header">Step number</th>
            <th scope="col" class="govuk-table__header">Description</th>
            <th scope="col" class="govuk-table__header">Status</th>
            <th scope="col" class="govuk-table__header">Target date</th>
          </tr>
        </thead>
        <tbody class="govuk-table__body">
          {% for step in data.steps %}
          <tr class="govuk-table__row">
            <th scope="row" class="govuk-table__header">{{ step.sequenceNumber }}</th>
            <td class="govuk-table__cell">{{ step.description }}</td>
            <td class="govuk-table__cell">{{ step.status }}</td>
            <td class="govuk-table__cell">{{ step.targetDate }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <form class="form" method="post" novalidate="">
        <input type="hidden" name="_csrf" value="{{ csrfToken }}" />
        <input type="hidden" name="reference" value="{{ form.reference }}" data-qa="goal-reference" />
        <input type="hidden" name="status" value="{{ form.status }}" data-qa="goal-status" />

        <div class="govuk-form-group govuk-!-margin-bottom-4">
          {{ govukButton({
            element: "a",
            text: "Go back to edit goal",
            classes: "moj-button-menu__item govuk-button--secondary",
            attributes: {
              'data-qa': 'goal-update-review-back-button'
            }
          }) }}
        </div>

        <div class="govuk-form-group">
          {{ govukButton({
            id: "submit-button",
            name: "submit-button",
            text: "Save to learning and work progress plan",
            classes: "moj-button-menu__item",
            attributes: {
              'data-qa': 'goal-update-review-submit-button'
            }
          }) }}
        </div>

      </form>

    </div>
  </div>

{% endblock %}

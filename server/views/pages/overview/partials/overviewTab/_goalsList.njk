{% for goal in goals.goals | sort(attribute = 'targetCompletionDate') %}
  {{ goalSummaryCard({
    goal: goal,
    attributes: {
      'data-qa': 'goal-summary-card'
    },
    actions: [
      {
        title: 'Update<span class="govuk-visually-hidden"> this goal</span>',
        href: '/plan/' + prisonerSummary.prisonNumber + '/goals/' + goal.goalReference + '/update',
        attributes: {
        'data-qa': 'goal-'+ loop.index + '-update-button'
      },
        'render-if': hasEditAuthority
      },
      {
        title: 'Archive<span class="govuk-visually-hidden"> this goal</span>',
        href: '/plan/' ~ prisonerSummary.prisonNumber ~ '/goals/' ~ goal.goalReference ~ '/archive',
        attributes: {
        'data-qa': 'goal-' ~ loop.index ~ '-archive-button'
      },
        'render-if': hasEditAuthority and not featureToggles.completedGoalsEnabled
      },
      {
        title: 'Complete or archive<span class="govuk-visually-hidden"> this goal</span>',
        href: '/plan/' ~ prisonerSummary.prisonNumber ~ '/goals/' ~ goal.goalReference ~ '/complete-or-archive',
        attributes: {
        'data-qa': 'goal-' ~ loop.index ~ '-completearchive-button'
      },
        'render-if': hasEditAuthority and featureToggles.completedGoalsEnabled
      }
    ]
  }) }}
{% endfor %}

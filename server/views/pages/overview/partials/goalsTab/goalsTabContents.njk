{% extends "../../../../partials/layout.njk" %}
{% set pageTitle = "Goals" %}
{% set pageId = "view-goals" %}
{% block beforeContent %}
  {% include "../../../../partials/breadcrumb.njk" %}
{% endblock %}
{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds app-u-print-full-width">
      <h1 class="govuk-heading-l" data-qa="page-heading">Test prisoner's learning and work progress</h1>
    </div>
    <div class="govuk-grid-column-one-third">
      {% include "../../../../partials/printThisPage.njk" %}
    </div>
  </div>
  {% include "../../../../partials/prisonerBanner.njk" %}
  {% include "./../../partials/navigation.njk" %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds app-u-print-full-width">
        {% set inProgressGoalsHtml %}
          {% if 1 > 0 %}
            <h2 class="govuk-heading-m">Goals in progress</h2>
            {{ goalSummaryCardV2({
                      goal: goal,
                      attributes: {
                        'data-qa': 'goal-summary-card'
                      },
                      actions: [
                        {
                          title: 'Update<span class="govuk-visually-hidden"> this goal</span>',
                          href: '/plan/12345/goals/12345/update',
                          attributes: {
                            'data-qa': 'goal-1-update-button'
                          },
                          'render-if': hasEditAuthority
                        },
                        {
                          title: 'Archive<span class="govuk-visually-hidden"> this goal</span>',
                          href: '/plan/12345/goals/12345/archive',
                          attributes: {
                            'data-qa': 'goal-2-archive-button'
                          },
                          'render-if': hasEditAuthority
                        }
                      ]
                    }) }}
          {% else %}
            <p class="govuk-body" data-qa="no-in-progress-goals-message">Test prisoner has no in progress goals.</p>
          {% endif %}
        {% endset -%}

        {% set archivedGoalsHtml %}
          {% if 1 > 0 %}
            <h2 class="govuk-heading-m">Archived goals</h2>
            {{ goalSummaryCardV2({
                      goal: goal,
                      attributes: {
                        'data-qa': 'goal-summary-card'
                      },
                      classes: 'archived-goal-summary-card',
                      lastUpdatedLabel: 'Archived on',
                      actions: [
                        {
                          title: 'Reactivate<span class="govuk-visually-hidden"> this goal</span>',
                          href: '/plan/12345/goals/12345/unarchive',
                          attributes: {
                            'data-qa': 'goal-12345-unarchive-button'
                          },
                          'render-if': hasEditAuthority
                        }
                      ]
                    }) }}
          {% else %}
            <p class="govuk-body" data-qa="no-archived-goals-message">Test prisoner has no archived goals.</p>
          {% endif %}
        {% endset -%}

        {{ govukTabs({
          items: [
            {
              label: "In progress (" + 1 + " goal" + ("s" if 1 !== 1) + ")",
              id: "in-progress-goals",
              panel: {
                html: inProgressGoalsHtml
              }
            },
            {
              label: "Archived (" + 1 + " goal" + ("s" if 1 !== 1) + ")",
              id: "archived-goals",
              panel: {
                html: archivedGoalsHtml
              }
            }
          ]
        }) }}
    </div>
    <div class="govuk-grid-column-one-third app-u-print-full-width">
      {{ actionsCard({
        actions: [
          { 
            title: '<img src="/assets/images/icon-goal.svg" role="presentation" alt="" width="35px" height="28px" /> Add a new goal' | safe, 
            href: '/plan/12345/goals/create', 
            id: 'add-goal-button', 
            'render-if': hasEditAuthority,
            attributes: {
              'data-qa': 'add-goal-button'
            }
          }
        ],
        attributes: {
          'data-qa': 'actions-card'
        },
        classes: 'govuk-!-display-none-print'
      }) }}
    </div>
  </div>
{% endblock %}
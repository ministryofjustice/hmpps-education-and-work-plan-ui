<div class="govuk-summary-card__content">
  {% include './_goalSteps.njk' %}

  {% if params.goal.status === 'COMPLETED' %}
      {% if params.goal.notesByType.GOAL_COMPLETION.length > 0 %}
        {% set goalCompletionNote = params.goal.notesByType.GOAL_COMPLETION[0] %}
        <p class="govuk-heading-s">Goal completion note</p>
        <p class="govuk-body">{{ goalCompletionNote.content }}</p>
      {% endif %}
    {% endif %}
    {% if params.goal.notesByType.GOAL.length > 0 %}
      {% set goalNote = params.goal.notesByType.GOAL[0] %}
      <details class="govuk-details app-notes-expander" data-qa="overview-notes-expander">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">
            {% if params.goal.status === 'COMPLETED' %}
              View previous note<span class="govuk-visually-hidden"> about this goal</span>
            {% else %}
              View note<span class="govuk-visually-hidden"> about this goal</span>
            {% endif %}
          </span>
        </summary>
        <div class="govuk-details__text">
          <span class="app-u-multiline-text">{{ goalNote.content }}</span>
        </div>
      </details>
    {% endif %}
  <p class="govuk-hint govuk-!-font-size-16" data-qa="goal-last-updated-hint">
    {{ params.lastUpdatedLabel | default('Last updated on') }} {{ params.goal.updatedAt | formatDate('DD MMMM YYYY') }}<span class="govuk-!-display-none-print"> by {{ params.goal.updatedByDisplayName }}{{ ', ' + params.goal.updatedAtPrisonName if params.goal.updatedAtPrisonName }}</span>
  </p>
  {% if params.goal.status === 'ARCHIVED' %}
    <p class="govuk-hint govuk-!-font-size-16" data-qa="goal-archive-reason-hint">Reason: {{ params.goal.archiveReason | formatReasonToArchiveGoal }}{{ ' - ' +  params.goal.archiveReasonOther if params.goal.archiveReason === 'OTHER'}}</p>
  {% endif %}
</div>
